{
  "html_content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Chrono Shifter: VG Music Generator</title>\n    <!-- Tailwind CSS CDN for styling -->\n    <script src=\"https://cdn.tailwindcss.com\"></script>\n    <!-- Tone.js CDN for audio synthesis -->\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js\"></script>\n    <style>\n        body {\n            font-family: 'Inter', sans-serif;\n            background-color: #1a202c; /* Dark background */\n            color: #e2e8f0; /* Light text */\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            min-height: 100vh;\n            padding: 20px;\n            box-sizing: border-box;\n        }\n        .container {\n            background-color: #2d3748; /* Slightly lighter dark background for container */\n            border-radius: 15px;\n            padding: 30px;\n            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);\n            text-align: center;\n            max-width: 600px;\n            width: 100%;\n            border: 1px solid #4a5568;\n        }\n        h1 {\n            font-size: 2.5rem;\n            font-weight: bold;\n            margin-bottom: 20px;\n            color: #63b3ed; /* Blue for title */\n        }\n        #current-section-info {\n            margin-top: 30px;\n            font-size: 1.2rem;\n            color: #a0aec0; /* Lighter grey for info */\n        }\n        #current-section-info span {\n            font-weight: bold;\n            color: #9f7aea; /* Purple for dynamic info */\n        }\n        .info-box {\n            background-color: #4a5568;\n            border-radius: 10px;\n            padding: 15px;\n            margin-top: 20px;\n            font-size: 0.9rem;\n            color: #cbd5e0;\n            text-align: left;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Chrono Shifter</h1>\n        <p class=\"text-lg mb-4\">A VG Music Generator</p>\n        <div id=\"current-section-info\">\n            <p>Current Section: <span id=\"section-name\">---</span></p>\n            <p>Scale: <span id=\"section-scale\">---</span></p>\n            <p>Rhythm Feel: <span id=\"section-rhythm\">---</span></p>\n            <p>Tempo: <span id=\"section-tempo\">---</span> BPM</p>\n        </div>\n        <div class=\"info-box\">\n            <p>Music will start automatically. Enjoy the dynamic shifts in scale and rhythm!</p>\n        </div>\n    </div>\n\n    <script>\n        // --- Global Variables and UI Elements ---\n        let currentSectionIndex = 0;\n        const sectionNameEl = document.getElementById('section-name');\n        const sectionScaleEl = document.getElementById('section-scale');\n        const sectionRhythmEl = document.getElementById('section-rhythm');\n        const sectionTempoEl = document.getElementById('section-tempo');\n\n        // --- Audio Effects Setup ---\n        // Reverb effect for spaciousness - now the only effect\n        const reverb = new Tone.Reverb({\n            decay: 1.5,    // Slightly shorter decay for less lingering\n            preDelay: 0.01,\n            wet: 0.3     // Slightly less wet for clarity\n        }).toDestination();\n\n        // --- Musical Instruments Setup ---\n        // Synth for melodies and pads, connected only to reverb\n        const leadSynth = new Tone.PolySynth(Tone.Synth, {\n            oscillator: { type: \"triangle\" },\n            envelope: { attack: 0.01, decay: 0.1, sustain: 0.05, release: 0.05 }, // Shorter release for crisp notes\n            volume: -10\n        }).connect(reverb).toDestination();\n\n        const padSynth = new Tone.PolySynth(Tone.Synth, {\n            oscillator: { type: \"sine\" },\n            envelope: { attack: 0.1, decay: 0.2, sustain: 0.1, release: 0.1 }, // Shorter overall envelope\n            volume: -15\n        }).connect(reverb).toDestination();\n\n        const bassSynth = new Tone.MonoSynth({\n            oscillator: { type: \"square\" },\n            envelope: { attack: 0.01, decay: 0.1, sustain: 0.05, release: 0.05 }, // Shorter release for crisp bass\n            filterEnvelope: { attack: 0.001, decay: 0.7, sustain: 0.1, release: 0.8, baseFrequency: 200, octaves: 4 },\n            volume: -8\n        }).toDestination(); // Bass usually doesn't need reverb for clarity\n\n        // Drums using Tone.MembraneSynth for kick and snare, Tone.NoiseSynth for hi-hats\n        // These already have short envelopes, but we'll ensure durations are short in patterns\n        const kick = new Tone.MembraneSynth({\n            pitchDecay: 0.05,\n            octaves: 10,\n            oscillator: { type: \"sine\" },\n            envelope: { attack: 0.001, decay: 0.4, sustain: 0.01, release: 0.1 }, // Slightly shorter release\n            volume: -10\n        }).toDestination();\n\n        const snare = new Tone.NoiseSynth({\n            noise: { type: \"white\" },\n            envelope: { attack: 0.005, decay: 0.1, sustain: 0.0, release: 0.05 },\n            volume: -12\n        }).toDestination();\n\n        const hiHat = new Tone.NoiseSynth({\n            noise: { type: \"white\" },\n            envelope: { attack: 0.001, decay: 0.05, sustain: 0.0, release: 0.01 },\n            volume: -18\n        }).toDestination();\n\n        const percSynth = new Tone.MetalSynth({\n            frequency: 200,\n            envelope: { attack: 0.001, decay: 0.1, sustain: 0.0, release: 0.05 },\n            harmonicity: 3.1,\n            modulationIndex: 23,\n            resonance: 4000,\n            octaves: 1,\n            volume: -15\n        }).toDestination();\n\n        // --- Musical Data: Scales and Chords ---\n        const scales = {\n            'C Major': ['C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4', 'C5'],\n            'E Natural Minor': ['E4', 'F#4', 'G4', 'A4', 'B4', 'C5', 'D5', 'E5'],\n            'D Phrygian Dominant': ['D4', 'Eb4', 'F#4', 'G4', 'A4', 'Bb4', 'C5', 'D5'],\n            'G Lydian': ['G4', 'A4', 'B4', 'C#5', 'D5', 'E5', 'F#5', 'G5']\n        };\n\n        // Helper function to get notes from a scale based on degree (0-indexed)\n        function getScaleNote(scaleName, degree, octaveOffset = 0) {\n            const scale = scales[scaleName];\n            if (!scale) return null;\n            const baseNote = scale[degree % scale.length];\n            const baseOctave = parseInt(baseNote.slice(-1));\n            const noteName = baseNote.slice(0, -1);\n            return noteName + (baseOctave + octaveOffset);\n        }\n\n        // --- Song Structure Definition (8-bar sections) ---\n        const songSections = [\n            {\n                name: \"Hero's Overture\",\n                scale: 'C Major',\n                rhythmFeel: 'Driving 4/4',\n                tempo: 120,\n                bars: 8,\n                lead: [\n                    // All durations shortened to 8n or 16n for crispness\n                    { time: '0:0:0', note: 'C4', duration: '8n' }, { time: '0:1:0', note: 'E4', duration: '8n' },\n                    { time: '0:2:0', note: 'G4', duration: '8n' }, { time: '0:3:0', note: 'C5', duration: '8n' },\n                    { time: '1:0:0', note: 'B4', duration: '8n' }, { time: '1:1:0', note: 'A4', duration: '8n' },\n                    { time: '1:2:0', note: 'G4', duration: '8n' }, { time: '1:3:0', note: 'F4', duration: '8n' },\n                    { time: '2:0:0', note: 'E4', duration: '8n' }, { time: '2:1:0', note: 'D4', duration: '8n' },\n                    { time: '2:2:0', note: 'C4', duration: '4n' }, // Slightly longer for emphasis\n                    { time: '4:0:0', note: 'C4', duration: '8n' }, { time: '4:1:0', note: 'E4', duration: '8n' },\n                    { time: '4:2:0', note: 'G4', duration: '8n' }, { time: '4:3:0', note: 'C5', duration: '8n' },\n                    { time: '5:0:0', note: 'B4', duration: '8n' }, { time: '5:1:0', note: 'A4', duration: '8n' },\n                    { time: '5:2:0', note: 'G4', duration: '8n' }, { time: '5:3:0', note: 'F4', duration: '8n' },\n                    { time: '6:0:0', note: 'E4', duration: '8n' }, { time: '6:1:0', note: 'D4', duration: '8n' },\n                    { time: '6:2:0', note: 'C4', duration: '2n' } // Slightly longer for emphasis\n                ],\n                pad: [\n                    // Pad chords shortened significantly\n                    { time: '0:0:0', note: ['C3', 'E3', 'G3'], duration: '2n' },\n                    { time: '1:0:0', note: ['G3', 'B3', 'D4'], duration: '2n' },\n                    { time: '2:0:0', note: ['A3', 'C4', 'E4'], duration: '2n' },\n                    { time: '3:0:0', note: ['F3', 'A3', 'C4'], duration: '2n' },\n                    { time: '4:0:0', note: ['C3', 'E3', 'G3'], duration: '2n' },\n                    { time: '5:0:0', note: ['G3', 'B3', 'D4'], duration: '2n' },\n                    { time: '6:0:0', note: ['A3', 'C4', 'E4'], duration: '2n' },\n                    { time: '7:0:0', note: ['F3', 'A3', 'C4'], duration: '2n' }\n                ],\n                bass: [\n                    // Bass notes shortened\n                    { time: '0:0:0', note: 'C2', duration: '8n' }, { time: '0:1:0', note: 'E2', duration: '8n' },\n                    { time: '0:2:0', note: 'G2', duration: '8n' }, { time: '0:3:0', note: 'A2', duration: '8n' },\n                    { time: '1:0:0', note: 'G2', duration: '8n' }, { time: '1:1:0', note: 'B2', duration: '8n' },\n                    { time: '1:2:0', note: 'D3', duration: '8n' }, { time: '1:3:0', note: 'E3', duration: '8n' },\n                    { time: '2:0:0', note: 'A2', duration: '8n' }, { time: '2:1:0', note: 'C3', duration: '8n' },\n                    { time: '2:2:0', note: 'E3', duration: '8n' }, { time: '2:3:0', note: 'F3', duration: '8n' },\n                    { time: '3:0:0', note: 'F2', duration: '8n' }, { time: '3:1:0', note: 'A2', duration: '8n' },\n                    { time: '3:2:0', note: 'C3', duration: '8n' }, { time: '3:3:0', note: 'D3', duration: '8n' },\n                    { time: '4:0:0', note: 'C2', duration: '8n' }, { time: '4:1:0', note: 'E2', duration: '8n' },\n                    { time: '4:2:0', note: 'G2', duration: '8n' }, { time: '4:3:0', note: 'A2', duration: '8n' },\n                    { time: '5:0:0', note: 'G2', duration: '8n' }, { time: '5:1:0', note: 'B2', duration: '8n' },\n                    { time: '5:2:0', note: 'D3', duration: '8n' }, { time: '5:3:0', note: 'E3', duration: '8n' },\n                    { time: '6:0:0', note: 'A2', duration: '8n' }, { time: '6:1:0', note: 'C3', duration: '8n' },\n                    { time: '6:2:0', note: 'E3', duration: '8n' }, { time: '6:3:0', note: 'F3', duration: '8n' },\n                    { time: '7:0:0', note: 'F2', duration: '8n' }, { time: '7:1:0', note: 'A2', duration: '8n' },\n                    { time: '7:2:0', note: 'C3', duration: '8n' }, { time: '7:3:0', note: 'D3', duration: '8n' }\n                ],\n                drums: [\n                    { time: '0:0:0', instrument: kick, duration: '16n' }, { time: '0:1:2', instrument: hiHat, duration: '16n' }, { time: '0:2:0', instrument: snare, duration: '16n' }, { time: '0:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '1:0:0', instrument: kick, duration: '16n' }, { time: '1:1:2', instrument: hiHat, duration: '16n' }, { time: '1:2:0', instrument: snare, duration: '16n' }, { time: '1:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '2:0:0', instrument: kick, duration: '16n' }, { time: '2:1:2', instrument: hiHat, duration: '16n' }, { time: '2:2:0', instrument: snare, duration: '16n' }, { time: '2:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '3:0:0', instrument: kick, duration: '16n' }, { time: '3:1:2', instrument: hiHat, duration: '16n' }, { time: '3:2:0', instrument: snare, duration: '16n' }, { time: '3:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '4:0:0', instrument: kick, duration: '16n' }, { time: '4:1:2', instrument: hiHat, duration: '16n' }, { time: '4:2:0', instrument: snare, duration: '16n' }, { time: '4:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '5:0:0', instrument: kick, duration: '16n' }, { time: '5:1:2', instrument: hiHat, duration: '16n' }, { time: '5:2:0', instrument: snare, duration: '16n' }, { time: '5:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '6:0:0', instrument: kick, duration: '16n' }, { time: '6:1:2', instrument: hiHat, duration: '16n' }, { time: '6:2:0', instrument: snare, duration: '16n' }, { time: '6:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '7:0:0', instrument: kick, duration: '16n' }, { time: '7:1:2', instrument: hiHat, duration: '16n' }, { time: '7:2:0', instrument: snare, duration: '16n' }, { time: '7:3:2', instrument: hiHat, duration: '16n' }\n                ]\n            },\n            {\n                name: \"Mystic Caverns\",\n                scale: 'E Natural Minor',\n                rhythmFeel: 'Flowing 6/8',\n                tempo: 90,\n                bars: 8,\n                lead: [\n                    // All durations shortened\n                    { time: '0:0:0', note: getScaleNote('E Natural Minor', 0, 0), duration: '16n' },\n                    { time: '0:0:2', note: getScaleNote('E Natural Minor', 2, 0), duration: '16n' },\n                    { time: '0:0:4', note: getScaleNote('E Natural Minor', 4, 0), duration: '16n' },\n                    { time: '0:1:0', note: getScaleNote('E Natural Minor', 2, 1), duration: '8n' },\n                    { time: '1:0:0', note: getScaleNote('E Natural Minor', 5, -1), duration: '16n' },\n                    { time: '1:0:2', note: getScaleNote('E Natural Minor', 0, 0), duration: '16n' },\n                    { time: '1:0:4', note: getScaleNote('E Natural Minor', 2, 0), duration: '16n' },\n                    { time: '1:1:0', note: getScaleNote('E Natural Minor', 4, 0), duration: '8n' },\n                    { time: '2:0:0', note: getScaleNote('E Natural Minor', 1, 0), duration: '16n' },\n                    { time: '2:0:2', note: getScaleNote('E Natural Minor', 3, 0), duration: '16n' },\n                    { time: '2:0:4', note: getScaleNote('E Natural Minor', 5, 0), duration: '16n' },\n                    { time: '2:1:0', note: getScaleNote('E Natural Minor', 3, 1), duration: '8n' },\n                    { time: '3:0:0', note: getScaleNote('E Natural Minor', 6, -1), duration: '16n' },\n                    { time: '3:0:2', note: getScaleNote('E Natural Minor', 1, 0), duration: '16n' },\n                    { time: '3:0:4', note: getScaleNote('E Natural Minor', 3, 0), duration: '16n' },\n                    { time: '3:1:0', note: getScaleNote('E Natural Minor', 5, 0), duration: '8n' },\n                    { time: '4:0:0', note: getScaleNote('E Natural Minor', 0, 0), duration: '16n' },\n                    { time: '4:0:2', note: getScaleNote('E Natural Minor', 2, 0), duration: '16n' },\n                    { time: '4:0:4', note: getScaleNote('E Natural Minor', 4, 0), duration: '16n' },\n                    { time: '4:1:0', note: getScaleNote('E Natural Minor', 2, 1), duration: '8n' },\n                    { time: '5:0:0', note: getScaleNote('E Natural Minor', 5, -1), duration: '16n' },\n                    { time: '5:0:2', note: getScaleNote('E Natural Minor', 0, 0), duration: '16n' },\n                    { time: '5:0:4', note: getScaleNote('E Natural Minor', 2, 0), duration: '16n' },\n                    { time: '5:1:0', note: getScaleNote('E Natural Minor', 4, 0), duration: '8n' },\n                    { time: '6:0:0', note: getScaleNote('E Natural Minor', 1, 0), duration: '16n' },\n                    { time: '6:0:2', note: getScaleNote('E Natural Minor', 3, 0), duration: '16n' },\n                    { time: '6:0:4', note: getScaleNote('E Natural Minor', 5, 0), duration: '16n' },\n                    { time: '6:1:0', note: getScaleNote('E Natural Minor', 3, 1), duration: '8n' },\n                    { time: '7:0:0', note: getScaleNote('E Natural Minor', 6, -1), duration: '16n' },\n                    { time: '7:0:2', note: getScaleNote('E Natural Minor', 1, 0), duration: '16n' },\n                    { time: '7:0:4', note: getScaleNote('E Natural Minor', 3, 0), duration: '16n' },\n                    { time: '7:1:0', note: getScaleNote('E Natural Minor', 5, 0), duration: '8n' }\n                ],\n                pad: [\n                    // Pad chords shortened\n                    { time: '0:0:0', note: ['E3', 'G3', 'B3'], duration: '1n' },\n                    { time: '1:0:0', note: ['A3', 'C4', 'E4'], duration: '1n' },\n                    { time: '2:0:0', note: ['D3', 'F#3', 'A3'], duration: '1n' },\n                    { time: '3:0:0', note: ['C3', 'E3', 'G3'], duration: '1n' },\n                    { time: '4:0:0', note: ['E3', 'G3', 'B3'], duration: '1n' },\n                    { time: '5:0:0', note: ['A3', 'C4', 'E4'], duration: '1n' },\n                    { time: '6:0:0', note: ['D3', 'F#3', 'A3'], duration: '1n' },\n                    { time: '7:0:0', note: ['C3', 'E3', 'G3'], duration: '1n' }\n                ],\n                bass: [\n                    // Bass notes shortened\n                    { time: '0:0:0', note: 'E2', duration: '4n' },\n                    { time: '1:0:0', note: 'A2', duration: '4n' },\n                    { time: '2:0:0', note: 'D2', duration: '4n' },\n                    { time: '3:0:0', note: 'C2', duration: '4n' },\n                    { time: '4:0:0', note: 'E2', duration: '4n' },\n                    { time: '5:0:0', note: 'A2', duration: '4n' },\n                    { time: '6:0:0', note: 'D2', duration: '4n' },\n                    { time: '7:0:0', note: 'C2', duration: '4n' }\n                ],\n                drums: [\n                    { time: '0:0:0', instrument: hiHat, duration: '16n' }, { time: '0:0:2', instrument: hiHat, duration: '16n' }, { time: '0:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '0:1:0', instrument: hiHat, duration: '16n' }, { time: '0:1:2', instrument: hiHat, duration: '16n' }, { time: '0:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '1:0:0', instrument: hiHat, duration: '16n' }, { time: '1:0:2', instrument: hiHat, duration: '16n' }, { time: '1:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '1:1:0', instrument: hiHat, duration: '16n' }, { time: '1:1:2', instrument: hiHat, duration: '16n' }, { time: '1:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '2:0:0', instrument: hiHat, duration: '16n' }, { time: '2:0:2', instrument: hiHat, duration: '16n' }, { time: '2:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '2:1:0', instrument: hiHat, duration: '16n' }, { time: '2:1:2', instrument: hiHat, duration: '16n' }, { time: '2:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '3:0:0', instrument: hiHat, duration: '16n' }, { time: '3:0:2', instrument: hiHat, duration: '16n' }, { time: '3:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '3:1:0', instrument: hiHat, duration: '16n' }, { time: '3:1:2', instrument: hiHat, duration: '16n' }, { time: '3:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '4:0:0', instrument: hiHat, duration: '16n' }, { time: '4:0:2', instrument: hiHat, duration: '16n' }, { time: '4:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '4:1:0', instrument: hiHat, duration: '16n' }, { time: '4:1:2', instrument: hiHat, duration: '16n' }, { time: '4:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '5:0:0', instrument: hiHat, duration: '16n' }, { time: '5:0:2', instrument: hiHat, duration: '16n' }, { time: '5:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '5:1:0', instrument: hiHat, duration: '16n' }, { time: '5:1:2', instrument: hiHat, duration: '16n' }, { time: '5:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '6:0:0', instrument: hiHat, duration: '16n' }, { time: '6:0:2', instrument: hiHat, duration: '16n' }, { time: '6:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '6:1:0', instrument: hiHat, duration: '16n' }, { time: '6:1:2', instrument: hiHat, duration: '16n' }, { time: '6:1:4', instrument: hiHat, duration: '16n' },\n                    { time: '7:0:0', instrument: hiHat, duration: '16n' }, { time: '7:0:2', instrument: hiHat, duration: '16n' }, { time: '7:0:4', instrument: hiHat, duration: '16n' },\n                    { time: '7:1:0', instrument: hiHat, duration: '16n' }, { time: '7:1:2', instrument: hiHat, duration: '16n' }, { time: '7:1:4', instrument: hiHat, duration: '16n' }\n                ]\n            },\n            {\n                name: \"Techno-Forge Battle\",\n                scale: 'D Phrygian Dominant',\n                rhythmFeel: 'Fast, Syncopated 4/4',\n                tempo: 140,\n                bars: 8,\n                lead: [\n                    // All durations shortened\n                    { time: '0:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '0:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '0:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '0:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '0:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '0:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '1:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '1:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '1:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '1:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '1:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '1:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '2:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '2:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '2:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '2:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '2:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '2:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '3:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '3:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '3:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '3:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '3:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '3:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '4:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '4:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '4:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '4:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '4:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '4:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '5:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '5:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '5:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '5:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '5:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '5:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '6:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '6:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '6:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '6:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '6:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '6:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' },\n                    { time: '7:0:0', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '16n' },\n                    { time: '7:0:2', note: getScaleNote('D Phrygian Dominant', 2, 0), duration: '16n' },\n                    { time: '7:0:3', note: getScaleNote('D Phrygian Dominant', 0, 0), duration: '32n' },\n                    { time: '7:0:3.5', note: getScaleNote('D Phrygian Dominant', 1, 0), duration: '32n' },\n                    { time: '7:1:0', note: getScaleNote('D Phrygian Dominant', 4, 0), duration: '16n' },\n                    { time: '7:1:2', note: getScaleNote('D Phrygian Dominant', 3, 0), duration: '16n' }\n                ],\n                pad: [\n                    // Pad chords shortened\n                    { time: '0:0:0', note: ['D3', 'A3', 'D4'], duration: '8n' },\n                    { time: '0:2:0', note: ['C3', 'G3', 'C4'], duration: '8n' },\n                    { time: '1:0:0', note: ['Bb2', 'F3', 'Bb3'], duration: '8n' },\n                    { time: '1:2:0', note: ['G2', 'D3', 'G3'], duration: '8n' },\n                    { time: '2:0:0', note: ['D3', 'A3', 'D4'], duration: '8n' },\n                    { time: '2:2:0', note: ['C3', 'G3', 'C4'], duration: '8n' },\n                    { time: '3:0:0', note: ['Bb2', 'F3', 'Bb3'], duration: '8n' },\n                    { time: '3:2:0', note: ['G2', 'D3', 'G3'], duration: '8n' },\n                    { time: '4:0:0', note: ['D3', 'A3', 'D4'], duration: '8n' },\n                    { time: '4:2:0', note: ['C3', 'G3', 'C4'], duration: '8n' },\n                    { time: '5:0:0', note: ['Bb2', 'F3', 'Bb3'], duration: '8n' },\n                    { time: '5:2:0', note: ['G2', 'D3', 'G3'], duration: '8n' },\n                    { time: '6:0:0', note: ['D3', 'A3', 'D4'], duration: '8n' },\n                    { time: '6:2:0', note: ['C3', 'G3', 'C4'], duration: '8n' },\n                    { time: '7:0:0', note: ['Bb2', 'F3', 'Bb3'], duration: '8n' },\n                    { time: '7:2:0', note: ['G2', 'D3', 'G3'], duration: '8n' }\n                ],\n                bass: [\n                    // Bass notes shortened\n                    { time: '0:0:0', note: 'D2', duration: '16n' }, { time: '0:0:2', note: 'D2', duration: '16n' },\n                    { time: '0:1:0', note: 'D2', duration: '16n' }, { time: '0:1:2', note: 'D2', duration: '16n' },\n                    { time: '0:2:0', note: 'C2', duration: '16n' }, { time: '0:2:2', note: 'C2', duration: '16n' },\n                    { time: '0:3:0', note: 'C2', duration: '16n' }, { time: '0:3:2', note: 'C2', duration: '16n' },\n                    { time: '1:0:0', note: 'Bb1', duration: '16n' }, { time: '1:0:2', note: 'Bb1', duration: '16n' },\n                    { time: '1:1:0', note: 'Bb1', duration: '16n' }, { time: '1:1:2', note: 'Bb1', duration: '16n' },\n                    { time: '1:2:0', note: 'G1', duration: '16n' }, { time: '1:2:2', note: 'G1', duration: '16n' },\n                    { time: '1:3:0', note: 'G1', duration: '16n' }, { time: '1:3:2', note: 'G1', duration: '16n' },\n                    { time: '2:0:0', note: 'D2', duration: '16n' }, { time: '2:0:2', note: 'D2', duration: '16n' },\n                    { time: '2:1:0', note: 'D2', duration: '16n' }, { time: '2:1:2', note: 'D2', duration: '16n' },\n                    { time: '2:2:0', note: 'C2', duration: '16n' }, { time: '2:2:2', note: 'C2', duration: '16n' },\n                    { time: '2:3:0', note: 'C2', duration: '16n' }, { time: '2:3:2', note: 'C2', duration: '16n' },\n                    { time: '3:0:0', note: 'Bb1', duration: '16n' }, { time: '3:0:2', note: 'Bb1', duration: '16n' },\n                    { time: '3:1:0', note: 'Bb1', duration: '16n' }, { time: '3:1:2', note: 'Bb1', duration: '16n' },\n                    { time: '3:2:0', note: 'G1', duration: '16n' }, { time: '3:2:2', note: 'G1', duration: '16n' },\n                    { time: '3:3:0', note: 'G1', duration: '16n' }, { time: '3:3:2', note: 'G1', duration: '16n' },\n                    { time: '4:0:0', note: 'D2', duration: '16n' }, { time: '4:0:2', note: 'D2', duration: '16n' },\n                    { time: '4:1:0', note: 'D2', duration: '16n' }, { time: '4:1:2', note: 'D2', duration: '16n' },\n                    { time: '4:2:0', note: 'C2', duration: '16n' }, { time: '4:2:2', note: 'C2', duration: '16n' },\n                    { time: '4:3:0', note: 'C2', duration: '16n' }, { time: '4:3:2', note: 'C2', duration: '16n' },\n                    { time: '5:0:0', note: 'Bb1', duration: '16n' }, { time: '5:0:2', note: 'Bb1', duration: '16n' },\n                    { time: '5:1:0', note: 'Bb1', duration: '16n' }, { time: '5:1:2', note: 'Bb1', duration: '16n' },\n                    { time: '5:2:0', note: 'G1', duration: '16n' }, { time: '5:2:2', note: 'G1', duration: '16n' },\n                    { time: '5:3:0', note: 'G1', duration: '16n' }, { time: '5:3:2', note: 'G1', duration: '16n' },\n                    { time: '6:0:0', note: 'D2', duration: '16n' }, { time: '6:0:2', note: 'D2', duration: '16n' },\n                    { time: '6:1:0', note: 'D2', duration: '16n' }, { time: '6:1:2', note: 'D2', duration: '16n' },\n                    { time: '6:2:0', note: 'C2', duration: '16n' }, { time: '6:2:2', note: 'C2', duration: '16n' },\n                    { time: '6:3:0', note: 'C2', duration: '16n' }, { time: '6:3:2', note: 'C2', duration: '16n' },\n                    { time: '7:0:0', note: 'Bb1', duration: '16n' }, { time: '7:0:2', note: 'Bb1', duration: '16n' },\n                    { time: '7:1:0', note: 'Bb1', duration: '16n' }, { time: '7:1:2', note: 'Bb1', duration: '16n' },\n                    { time: '7:2:0', note: 'G1', duration: '16n' }, { time: '7:2:2', note: 'G1', duration: '16n' },\n                    { time: '7:3:0', note: 'G1', duration: '16n' }, { time: '7:3:2', note: 'G1', duration: '16n' }\n                ],\n                drums: [\n                    { time: '0:0:0', instrument: kick, duration: '16n' }, { time: '0:0:2', instrument: snare, duration: '16n' }, { time: '0:1:0', instrument: kick, duration: '16n' }, { time: '0:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '0:2:0', instrument: kick, duration: '16n' }, { time: '0:2:2', instrument: snare, duration: '16n' }, { time: '0:3:0', instrument: kick, duration: '16n' }, { time: '0:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '0:0:0', instrument: percSynth, duration: '32n' }, { time: '0:0:1', instrument: percSynth, duration: '32n' }, { time: '0:0:2', instrument: percSynth, duration: '32n' }, { time: '0:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '0:1:0', instrument: percSynth, duration: '32n' }, { time: '0:1:1', instrument: percSynth, duration: '32n' }, { time: '0:1:2', instrument: percSynth, duration: '32n' }, { time: '0:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '0:2:0', instrument: percSynth, duration: '32n' }, { time: '0:2:1', instrument: percSynth, duration: '32n' }, { time: '0:2:2', instrument: percSynth, duration: '32n' }, { time: '0:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '0:3:0', instrument: percSynth, duration: '32n' }, { time: '0:3:1', instrument: percSynth, duration: '32n' }, { time: '0:3:2', instrument: percSynth, duration: '32n' }, { time: '0:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '1:0:0', instrument: kick, duration: '16n' }, { time: '1:0:2', instrument: snare, duration: '16n' }, { time: '1:1:0', instrument: kick, duration: '16n' }, { time: '1:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '1:2:0', instrument: kick, duration: '16n' }, { time: '1:2:2', instrument: snare, duration: '16n' }, { time: '1:3:0', instrument: kick, duration: '16n' }, { time: '1:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '1:0:0', instrument: percSynth, duration: '32n' }, { time: '1:0:1', instrument: percSynth, duration: '32n' }, { time: '1:0:2', instrument: percSynth, duration: '32n' }, { time: '1:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '1:1:0', instrument: percSynth, duration: '32n' }, { time: '1:1:1', instrument: percSynth, duration: '32n' }, { time: '1:1:2', instrument: percSynth, duration: '32n' }, { time: '1:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '1:2:0', instrument: percSynth, duration: '32n' }, { time: '1:2:1', instrument: percSynth, duration: '32n' }, { time: '1:2:2', instrument: percSynth, duration: '32n' }, { time: '1:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '1:3:0', instrument: percSynth, duration: '32n' }, { time: '1:3:1', instrument: percSynth, duration: '32n' }, { time: '1:3:2', instrument: percSynth, duration: '32n' }, { time: '1:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '2:0:0', instrument: kick, duration: '16n' }, { time: '2:0:2', instrument: snare, duration: '16n' }, { time: '2:1:0', instrument: kick, duration: '16n' }, { time: '2:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '2:2:0', instrument: kick, duration: '16n' }, { time: '2:2:2', instrument: snare, duration: '16n' }, { time: '2:3:0', instrument: kick, duration: '16n' }, { time: '2:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '2:0:0', instrument: percSynth, duration: '32n' }, { time: '2:0:1', instrument: percSynth, duration: '32n' }, { time: '2:0:2', instrument: percSynth, duration: '32n' }, { time: '2:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '2:1:0', instrument: percSynth, duration: '32n' }, { time: '2:1:1', instrument: percSynth, duration: '32n' }, { time: '2:1:2', instrument: percSynth, duration: '32n' }, { time: '2:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '2:2:0', instrument: percSynth, duration: '32n' }, { time: '2:2:1', instrument: percSynth, duration: '32n' }, { time: '2:2:2', instrument: percSynth, duration: '32n' }, { time: '2:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '2:3:0', instrument: percSynth, duration: '32n' }, { time: '2:3:1', instrument: percSynth, duration: '32n' }, { time: '2:3:2', instrument: percSynth, duration: '32n' }, { time: '2:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '3:0:0', instrument: kick, duration: '16n' }, { time: '3:0:2', instrument: snare, duration: '16n' }, { time: '3:1:0', instrument: kick, duration: '16n' }, { time: '3:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '3:2:0', instrument: kick, duration: '16n' }, { time: '3:2:2', instrument: snare, duration: '16n' }, { time: '3:3:0', instrument: kick, duration: '16n' }, { time: '3:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '3:0:0', instrument: percSynth, duration: '32n' }, { time: '3:0:1', instrument: percSynth, duration: '32n' }, { time: '3:0:2', instrument: percSynth, duration: '32n' }, { time: '3:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '3:1:0', instrument: percSynth, duration: '32n' }, { time: '3:1:1', instrument: percSynth, duration: '32n' }, { time: '3:1:2', instrument: percSynth, duration: '32n' }, { time: '3:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '3:2:0', instrument: percSynth, duration: '32n' }, { time: '3:2:1', instrument: percSynth, duration: '32n' }, { time: '3:2:2', instrument: percSynth, duration: '32n' }, { time: '3:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '3:3:0', instrument: percSynth, duration: '32n' }, { time: '3:3:1', instrument: percSynth, duration: '32n' }, { time: '3:3:2', instrument: percSynth, duration: '32n' }, { time: '3:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '4:0:0', instrument: kick, duration: '16n' }, { time: '4:0:2', instrument: snare, duration: '16n' }, { time: '4:1:0', instrument: kick, duration: '16n' }, { time: '4:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '4:2:0', instrument: kick, duration: '16n' }, { time: '4:2:2', instrument: snare, duration: '16n' }, { time: '4:3:0', instrument: kick, duration: '16n' }, { time: '4:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '4:0:0', instrument: percSynth, duration: '32n' }, { time: '4:0:1', instrument: percSynth, duration: '32n' }, { time: '4:0:2', instrument: percSynth, duration: '32n' }, { time: '4:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '4:1:0', instrument: percSynth, duration: '32n' }, { time: '4:1:1', instrument: percSynth, duration: '32n' }, { time: '4:1:2', instrument: percSynth, duration: '32n' }, { time: '4:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '4:2:0', instrument: percSynth, duration: '32n' }, { time: '4:2:1', instrument: percSynth, duration: '32n' }, { time: '4:2:2', instrument: percSynth, duration: '32n' }, { time: '4:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '4:3:0', instrument: percSynth, duration: '32n' }, { time: '4:3:1', instrument: percSynth, duration: '32n' }, { time: '4:3:2', instrument: percSynth, duration: '32n' }, { time: '4:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '5:0:0', instrument: kick, duration: '16n' }, { time: '5:0:2', instrument: snare, duration: '16n' }, { time: '5:1:0', instrument: kick, duration: '16n' }, { time: '5:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '5:2:0', instrument: kick, duration: '16n' }, { time: '5:2:2', instrument: snare, duration: '16n' }, { time: '5:3:0', instrument: kick, duration: '16n' }, { time: '5:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '5:0:0', instrument: percSynth, duration: '32n' }, { time: '5:0:1', instrument: percSynth, duration: '32n' }, { time: '5:0:2', instrument: percSynth, duration: '32n' }, { time: '5:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '5:1:0', instrument: percSynth, duration: '32n' }, { time: '5:1:1', instrument: percSynth, duration: '32n' }, { time: '5:1:2', instrument: percSynth, duration: '32n' }, { time: '5:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '5:2:0', instrument: percSynth, duration: '32n' }, { time: '5:2:1', instrument: percSynth, duration: '32n' }, { time: '5:2:2', instrument: percSynth, duration: '32n' }, { time: '5:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '5:3:0', instrument: percSynth, duration: '32n' }, { time: '5:3:1', instrument: percSynth, duration: '32n' }, { time: '5:3:2', instrument: percSynth, duration: '32n' }, { time: '5:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '6:0:0', instrument: kick, duration: '16n' }, { time: '6:0:2', instrument: snare, duration: '16n' }, { time: '6:1:0', instrument: kick, duration: '16n' }, { time: '6:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '6:2:0', instrument: kick, duration: '16n' }, { time: '6:2:2', instrument: snare, duration: '16n' }, { time: '6:3:0', instrument: kick, duration: '16n' }, { time: '6:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '6:0:0', instrument: percSynth, duration: '32n' }, { time: '6:0:1', instrument: percSynth, duration: '32n' }, { time: '6:0:2', instrument: percSynth, duration: '32n' }, { time: '6:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '6:1:0', instrument: percSynth, duration: '32n' }, { time: '6:1:1', instrument: percSynth, duration: '32n' }, { time: '6:1:2', instrument: percSynth, duration: '32n' }, { time: '6:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '6:2:0', instrument: percSynth, duration: '32n' }, { time: '6:2:1', instrument: percSynth, duration: '32n' }, { time: '6:2:2', instrument: percSynth, duration: '32n' }, { time: '6:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '6:3:0', instrument: percSynth, duration: '32n' }, { time: '6:3:1', instrument: percSynth, duration: '32n' }, { time: '6:3:2', instrument: percSynth, duration: '32n' }, { time: '6:3:3', instrument: percSynth, duration: '32n' },\n\n                    { time: '7:0:0', instrument: kick, duration: '16n' }, { time: '7:0:2', instrument: snare, duration: '16n' }, { time: '7:1:0', instrument: kick, duration: '16n' }, { time: '7:1:2', instrument: hiHat, duration: '16n' },\n                    { time: '7:2:0', instrument: kick, duration: '16n' }, { time: '7:2:2', instrument: snare, duration: '16n' }, { time: '7:3:0', instrument: kick, duration: '16n' }, { time: '7:3:2', instrument: hiHat, duration: '16n' },\n                    { time: '7:0:0', instrument: percSynth, duration: '32n' }, { time: '7:0:1', instrument: percSynth, duration: '32n' }, { time: '7:0:2', instrument: percSynth, duration: '32n' }, { time: '7:0:3', instrument: percSynth, duration: '32n' },\n                    { time: '7:1:0', instrument: percSynth, duration: '32n' }, { time: '7:1:1', instrument: percSynth, duration: '32n' }, { time: '7:1:2', instrument: percSynth, duration: '32n' }, { time: '7:1:3', instrument: percSynth, duration: '32n' },\n                    { time: '7:2:0', instrument: percSynth, duration: '32n' }, { time: '7:2:1', instrument: percSynth, duration: '32n' }, { time: '7:2:2', instrument: percSynth, duration: '32n' }, { time: '7:2:3', instrument: percSynth, duration: '32n' },\n                    { time: '7:3:0', instrument: percSynth, duration: '32n' }, { time: '7:3:1', instrument: percSynth, duration: '32n' }, { time: '7:3:2', instrument: percSynth, duration: '32n' }, { time: '7:3:3', instrument: percSynth, duration: '32n' }\n                ]\n            },\n            {
                name: \"Forest Sanctuary\",
                scale: 'G Lydian',
                rhythmFeel: 'Slow, Spacious 4/4',
                tempo: 80,
                bars: 8,
                lead: [
                    // All durations shortened
                    { time: '0:0:0', note: getScaleNote('G Lydian', 0, 0), duration: '8n' },
                    { time: '0:2:0', note: getScaleNote('G Lydian', 2, 0), duration: '8n' },
                    { time: '1:0:0', note: getScaleNote('G Lydian', 4, 0), duration: '8n' },
                    { time: '1:2:0', note: getScaleNote('G Lydian', 6, 0), duration: '8n' },
                    { time: '2:0:0', note: getScaleNote('G Lydian', 1, 1), duration: '8n' },
                    { time: '2:2:0', note: getScaleNote('G Lydian', 3, 1), duration: '8n' },
                    { time: '3:0:0', note: getScaleNote('G Lydian', 5, 1), duration: '8n' },
                    { time: '3:2:0', note: getScaleNote('G Lydian', 0, 1), duration: '8n' },
                    { time: '4:0:0', note: getScaleNote('G Lydian', 0, 0), duration: '8n' },
                    { time: '4:2:0', note: getScaleNote('G Lydian', 2, 0), duration: '8n' },
                    { time: '5:0:0', note: getScaleNote('G Lydian', 4, 0), duration: '8n' },
                    { time: '5:2:0', note: getScaleNote('G Lydian', 6, 0), duration: '8n' },
                    { time: '6:0:0', note: getScaleNote('G Lydian', 1, 1), duration: '8n' },
                    { time: '6:2:0', note: getScaleNote('G Lydian', 3, 1), duration: '8n' },
                    { time: '7:0:0', note: getScaleNote('G Lydian', 5, 1), duration: '8n' },
                    { time: '7:2:0', note: getScaleNote('G Lydian', 0, 1), duration: '8n' }
                ],\n                pad: [\n                    // Pad chords shortened\n                    { time: '0:0:0', note: ['G3', 'B3', 'D4', 'F#4'], duration: '2n' },\n                    { time: '1:0:0', note: ['C#3', 'E3', 'G3', 'B3'], duration: '2n' },\n                    { time: '2:0:0', note: ['D3', 'G3', 'A3', 'C4'], duration: '2n' },\n                    { time: '3:0:0', note: ['G3', 'B3', 'D4', 'F#4'], duration: '2n' },\n                    { time: '4:0:0', note: ['G3', 'B3', 'D4', 'F#4'], duration: '2n' },\n                    { time: '5:0:0', note: ['C#3', 'E3', 'G3', 'B3'], duration: '2n' },\n                    { time: '6:0:0', note: ['D3', 'G3', 'A3', 'C4'], duration: '2n' },\n                    { time: '7:0:0', note: ['G3', 'B3', 'D4', 'F#4'], duration: '2n' }\n                ],\n                bass: [\n                    // Bass notes shortened\n                    { time: '0:0:0', note: 'G2', duration: '4n' },\n                    { time: '1:0:0', note: 'C#2', duration: '4n' },\n                    { time: '2:0:0', note: 'D2', duration: '4n' },\n                    { time: '3:0:0', note: 'G2', duration: '4n' },\n                    { time: '4:0:0', note: 'G2', duration: '4n' },\n                    { time: '5:0:0', note: 'C#2', duration: '4n' },\n                    { time: '6:0:0', note: 'D2', duration: '4n' },\n                    { time: '7:0:0', note: 'G2', duration: '4n' }\n                ],\n                drums: [\n                    { time: '0:0:0', instrument: hiHat, duration: '1n' }, // Gentle cymbal swell\n                    { time: '4:0:0', instrument: hiHat, duration: '1n' }\n                ]\n            }\n        ];\n\n        // --- Tone.js Parts for each instrument ---\n        let leadPart, padPart, bassPart, drumPart;\n\n        // Function to clear existing parts\n        function clearParts() {\n            if (leadPart) leadPart.dispose();\n            if (padPart) padPart.dispose();\n            if (bassPart) bassPart.dispose();\n            if (drumPart) drumPart.dispose();\n        }\n\n        // --- Core Music Scheduling Logic ---\n        function setupSection(section) {\n            // Clear previous parts to avoid overlapping sounds\n            clearParts();\n\n            // Set global tempo\n            Tone.Transport.bpm.value = section.tempo;\n\n            // Update UI\n            sectionNameEl.textContent = section.name;\n            sectionScaleEl.textContent = section.scale;\n            sectionRhythmEl.textContent = section.rhythmFeel;\n            sectionTempoEl.textContent = section.tempo;\n\n            // Create new Tone.Parts for the current section's patterns\n            leadPart = new Tone.Part((time, note) => {\n                leadSynth.triggerAttackRelease(note.note, note.duration, time);\n            }, section.lead).start(0);\n\n            padPart = new Tone.Part((time, note) => {\n                padSynth.triggerAttackRelease(note.note, note.duration, time);\n            }, section.pad).start(0);\n\n            bassPart = new Tone.Part((time, note) => {\n                bassSynth.triggerAttackRelease(note.note, note.duration, time);\n            }, section.bass).start(0);\n\n            drumPart = new Tone.Part((time, event) => {\n                // Handle drum events: each event specifies which instrument to trigger\n                // The duration is now explicitly defined in the event data.\n                if (event.instrument === kick) kick.triggerAttackRelease('C1', event.duration, time);\n                else if (event.instrument === snare) snare.triggerAttackRelease('C1', event.duration, time);\n                else if (event.instrument === hiHat) hiHat.triggerAttackRelease('C1', event.duration, time);\n                else if (event.instrument === percSynth) percSynth.triggerAttackRelease('C1', event.duration, time);\n            }, section.drums).start(0);\n\n            // Set loop points for each part to match the section length (8 bars)\n            leadPart.loop = true;\n            leadPart.loopEnd = `${section.bars}m`;\n            padPart.loop = true;\n            padPart.loopEnd = `${section.bars}m`;\n            bassPart.loop = true;\n            bassPart.loopEnd = `${section.bars}m`;\n            drumPart.loop = true;\n            drumPart.loopEnd = `${section.bars}m`;\n\n            console.log(`Switched to section: ${section.name} at tempo ${section.tempo}`);\n        }\n\n        // Main loop to advance sections\n        Tone.Transport.scheduleRepeat((time) => {\n            const nextSectionIndex = (currentSectionIndex + 1) % songSections.length;\n            currentSectionIndex = nextSectionIndex;\n            setupSection(songSections[currentSectionIndex]);\n        }, \"8m\"); // \"8m\" means 8 measures (bars)\n\n        // --- Autoplay on Window Load ---\n        window.addEventListener('load', async () => {\n            // Tone.js requires user interaction to start the audio context in some browsers.\n            // Tone.start() handles this by resuming the context.\n            await Tone.start();\n            Tone.Transport.start();\n            setupSection(songSections[currentSectionIndex]); // Start the first section\n            console.log(\"Music started automatically!\");\n        });\n\n        // Initial UI state (before autoplay starts)\n        window.onload = function() {\n            sectionNameEl.textContent = 'Loading...';\n            sectionScaleEl.textContent = 'N/A';\n            sectionRhythmEl.textContent = 'N/A';\n            sectionTempoEl.textContent = 'N/A';\n        };\n\n    </script>\n</body>\n</html>"
}
